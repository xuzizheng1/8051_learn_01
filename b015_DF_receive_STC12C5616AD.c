/*********************************************************************************************
程序名： 　　 无线模块实验1程序
编写人： 　　 杜洋　
编写时间：　　2010年9月1日
硬件支持：　　STC12C5616AD 外部晶体12MHz
接口说明：　　P1.0接口接无线接收  
修改日志：　　
　　1-20100916 简单的读一个位的程序								
*********************************************************************************************/



#include <STC12C5620AD.H> // STC12C5616AD 凑合用

sbit IN  = P3 ^ 7; 
sbit LED  = P1 ^ 7; //
unsigned char R;
/*********************************************************************************************
函数名：毫秒级CPU延时函数
调  用：DELAY_MS (?);
参  数：1~65535（参数不可为0）
返回值：无
结  果：占用CPU方式延时与参数数值相同的毫秒时间
备  注：应用于1T单片机时i<600，应用于12T单片机时i<125
/*********************************************************************************************/
void DELAY_MS (unsigned int a){
	unsigned int i;
	while( a-- != 0){
		for(i = 0; i < 600; i++);
	}
}
/*********************************************************************************************/
/**********************************************************************************************/
void BR (void){
	unsigned char i;
	for(i=0;i<8;i++){
		DELAY_MS (60);
		R = R | IN;
		R = R << 1;
	}
}
/*********************************************************************************************
函数名：主函数
调  用：无
参  数：无
返回值：无
结  果：程序开始处，无限循环
备  注：
/**********************************************************************************************/
void main (void){
	unsigned char i,cou;
	while(1){
		if(IN == 1){
			for(i=0;i<60;i++){
				DELAY_MS (1);
				if(IN == 1){
					cou++;
				}
			}
			if(cou > 50){
				for(i=0;i<40;i++){
					DELAY_MS (1);
					if(IN == 1){
						cou++;
					}
				}
			}




			if(IN == 1){
				DELAY_MS (50);
				if(IN == 0){
					while(IN == 0);
					BR();
					P1 = R;
					if(R == 0x05){
						LED = ~LED;
					}
				}
			}
		}
	}
}

/**********************************************************************************************/
